---
phase: 01-tooling-practice
plan: "01"
type: execute
wave: 1
depends_on: []
files_modified:
  - docs/decisions/README.org
  - docs/decisions/0000-template.org
  - docs/decisions/images/.gitkeep
  - CONTRIBUTING.org
autonomous: true
requirements:
  - ADR-01
  - ADR-02
  - ADR-03
  - DEV-05

must_haves:
  truths:
    - "docs/decisions/ directory exists and contains a MADR 4.0 template in org-mode format"
    - "CONTRIBUTING.org exists and captures all developer practice rules: tidy-up, ADR-first, TDD red-green-refactor, public-interface testing, no bulk tests, Mermaid diagrams in ADRs"
    - "Any contributor reading docs/decisions/ understands the ADR convention used by this project"
  artifacts:
    - path: "docs/decisions/README.org"
      provides: "Human-readable guide to the ADR process for this project"
    - path: "docs/decisions/0000-template.org"
      provides: "MADR 4.0 template in org-mode format — the blank form every new ADR copies; includes optional Mermaid diagram section"
    - path: "docs/decisions/images/.gitkeep"
      provides: "Ensures the images/ directory is tracked in git for ADR SVG output files"
    - path: "CONTRIBUTING.org"
      provides: "Developer practice rules: TDD workflow, ADR-first mandate, tidy-up requirement, testing constraints, Mermaid diagram convention"
  key_links:
    - from: "docs/decisions/0000-template.org"
      to: "docs/decisions/0001-vitest.org (Plan 03)"
      via: "Template is copied and filled in for each ADR"
      pattern: "MADR 4.0 structure: title, status, context, decision, consequences"
    - from: "CONTRIBUTING.org"
      to: "Every subsequent phase plan"
      via: "Phase plans reference CONTRIBUTING.org as the authoritative rule set"
      pattern: "red-green-refactor, one test at a time, public interface only"
---

<objective>
Initialize the ADR infrastructure and capture developer practice rules before any feature code is written.

Purpose: Every subsequent phase must have a place to document architectural decisions (docs/decisions/) and a rules document (CONTRIBUTING.org) to constrain how code is written. These are the guardrails — they must exist before code.

Output:
- docs/decisions/ directory with MADR 4.0 org-mode template (including Mermaid diagram section)
- docs/decisions/images/ directory tracked in git (for SVG output from ob-mermaid)
- CONTRIBUTING.org capturing all locked developer practice rules from STATE.org, including Mermaid diagram convention
</objective>

<execution_context>
@/Users/xavierbrinon/.config/Claude/get-shit-done/workflows/execute-plan.md
@/Users/xavierbrinon/.config/Claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.org
@.planning/ROADMAP.org
@.planning/STATE.org
</context>

<tasks>

<task type="auto">
  <name>Task 1: Initialize docs/decisions/ with MADR 4.0 org-mode template</name>
  <files>docs/decisions/README.org
docs/decisions/0000-template.org
docs/decisions/images/.gitkeep</files>
  <action>
Create the docs/decisions/ directory (create parent docs/ if needed).
Create docs/decisions/images/ directory with a .gitkeep file so it is tracked
in git. This directory holds SVG files generated by ob-mermaid when executing
mermaid src blocks in ADR files.

Write docs/decisions/README.org explaining:
- What ADRs are and why this project uses them
- File naming: NNNN-short-title.org (four-digit zero-padded, kebab-case)
- When to write an ADR: before any architecturally significant decision — new library, structural pattern, data format, developer workflow
- The mandate from ADR-02: one ADR per significant decision, written BEFORE implementation
- How to use the template: copy 0000-template.org, rename, fill in sections
- The Mermaid diagram convention: use ob-mermaid #+begin_src mermaid :file ./images/NNNN-TITLE.svg blocks when a decision involves a flow, state transition, dependency graph, or data structure

Write docs/decisions/0000-template.org as a blank MADR 4.0 template in org-mode format. The template must have these sections:

  #+title: [short title of solved problem and solution]
  #+author: BookTab
  #+date: [YYYY-MM-DD]
  #+startup: indent
  #+options: toc:nil num:nil ^:{}

  * Status
    [Proposed | Accepted | Deprecated | Superseded by NNNN]

  * Context and Problem Statement
    [Describe the context and problem. Why is this decision needed?]

  * Decision Drivers
    - [driver 1, e.g. performance, simplicity, consistency]

  * Considered Options
    - [Option 1]
    - [Option 2]

  * Decision Outcome
    Chosen option: "[option]", because [justification]

    ** Positive Consequences
       - [e.g. proven solution, well-known]

    ** Negative Consequences / Trade-offs
       - [e.g. more dependencies]

  * Pros and Cons of the Options

    ** [Option 1]
       - Good, because [argument]
       - Bad, because [argument]

    ** [Option 2]
       - Good, because [argument]
       - Bad, because [argument]

  * Diagram (optional)
    When this decision involves a flow, state transition, dependency graph, or
    data structure, include a Mermaid diagram below. The :file header argument
    is required for ob-mermaid to execute (C-c C-c). Use SVG format. Output
    is committed alongside the source block.

    #+begin_src mermaid :file ./images/NNNN-short-title.svg :theme neutral
    %% Replace with your diagram. Examples:
    %% graph TD, sequenceDiagram, flowchart LR, stateDiagram-v2
    graph TD
        A[Decision] --> B[Consequence]
    #+end_src
    #+RESULTS:
    [[file:./images/NNNN-short-title.svg]]

The template must be valid org-mode (headings with *, property drawers optional). Sections must match MADR 4.0 structure. Use org-mode format throughout — no markdown.
  </action>
  <verify>
    <automated>ls docs/decisions/README.org docs/decisions/0000-template.org docs/decisions/images/.gitkeep && grep -l "Status" docs/decisions/0000-template.org && grep -l "Decision Outcome" docs/decisions/0000-template.org && grep -l "mermaid" docs/decisions/0000-template.org</automated>
  </verify>
  <done>docs/decisions/ exists; docs/decisions/images/ exists with .gitkeep; README.org explains the ADR process including Mermaid convention; 0000-template.org contains all MADR 4.0 sections plus the optional Mermaid diagram section in org-mode format</done>
</task>

<task type="auto">
  <name>Task 2: Write CONTRIBUTING.org with locked developer practice rules</name>
  <files>CONTRIBUTING.org</files>
  <action>
Create CONTRIBUTING.org in the project root. This document captures the
developer practice rules that are locked-in for all phases of this project
(from STATE.org "Developer practice rules" section). It must be written as
authoritative rules, not suggestions.

The document must cover all of these locked rules:

1. **Mandatory tidy-up before new features** (DEV-05): Every phase begins with
   a refactoring/cleanup pass before any new feature code. No exceptions.
   Purpose: keep codebase clean before adding complexity.

2. **ADR before implementation** (ADR-02, ADR-03): An ADR is written
   immediately before implementing any architecturally significant decision,
   at whatever phase that decision arises. If a decision changes later, a
   new ADR is written that supersedes the previous one ("Superseded by NNNN"
   status on the old ADR). The history is never rewritten -- only extended.
   This produces a complete, honest decision log for learning purposes.
   Significant decisions include: choosing a library, defining a data
   format, selecting a state management pattern, establishing a coding
   convention.

3. **TDD red-green-refactor vertical slicing** (DEV-02, DEV-03): Write one
   failing test → write minimal implementation to pass it → refactor if needed
   → repeat. No writing tests in bulk after implementation is complete. One
   test, one implementation unit, then the next.

4. **Public interface testing only** (DEV-04): Tests exercise the public API
   of a module — what it exports, what it accepts, what it returns. No testing
   internal functions, no mocking internal implementation details. If a
   function is not exported, it should not be tested directly.

5. **No bulk test writing** (DEV-03): Tests are NOT written all at once after
   feature code. Each test is written before the code that makes it pass.

6. **Mermaid diagrams in ADRs**: When an ADR describes a flow, state
   transition, dependency graph, or data structure, include a Mermaid diagram
   using ob-mermaid syntax:

     #+begin_src mermaid :file ./images/NNNN-short-title.svg :theme neutral
     ...diagram content...
     #+end_src
     #+RESULTS:
     [[file:./images/NNNN-short-title.svg]]

   The :file header argument is required for ob-mermaid to execute (C-c C-c).
   Use SVG format (.svg). Generated SVG files are committed to git alongside
   the source block. Diagrams are optional but strongly encouraged when they
   reduce reading time.

7. **File format exception -- GSD workflow artefacts**: All project
   documentation is in org-mode (.org files). The one exception is
   .planning/phases/**/*-PLAN.md and *-SUMMARY.md files. These must keep
   the .md extension because the GSD tooling (gsd-tools.cjs) hardcodes
   endsWith('-PLAN.md') and endsWith('-SUMMARY.md') when discovering plans
   and tracking progress. Renaming them would silently break execution.
   These files use YAML frontmatter + XML task blocks (GSD format) --
   they are tooling artefacts, not documentation. Do not convert them.

Format the document in org-mode. Include a short rationale for each rule so
future contributors understand the "why" not just the "what". Use #+title:,
* sections, and org-mode list formatting throughout.
  </action>
  <verify>
    <automated>ls CONTRIBUTING.org && grep -c "red-green-refactor\|tidy-up\|ADR\|public interface\|bulk\|mermaid" CONTRIBUTING.org | grep -v "^0$"</automated>
  </verify>
  <done>CONTRIBUTING.org exists; contains all six practice rules (tidy-up, ADR-first, red-green-refactor, public-interface testing, no bulk tests, Mermaid diagrams); each rule has a rationale; document is valid org-mode</done>
</task>

</tasks>

<verification>
After both tasks complete:
1. `ls docs/decisions/` shows README.org, 0000-template.org, and images/
2. `cat docs/decisions/0000-template.org` shows all MADR 4.0 sections including the Mermaid diagram section
3. `cat CONTRIBUTING.org` shows all 6 practice rules with rationale
4. Both files are valid org-mode (#+title:, * headings, no stray markdown syntax)
5. `grep mermaid docs/decisions/0000-template.org` returns matches
6. `grep mermaid CONTRIBUTING.org` returns matches
</verification>

<success_criteria>
- docs/decisions/ directory initialized with MADR 4.0 template (ADR-01 ✓)
- docs/decisions/images/ directory exists and is git-tracked (for SVG output)
- CONTRIBUTING.org captures all locked developer practice rules including Mermaid convention (DEV-05 ✓)
- Any contributor reading these files understands the ADR convention, TDD workflow, and diagram practice
- ADR-02 and ADR-03 are structurally enforced: the template exists; CONTRIBUTING.org mandates writing ADRs before decisions
</success_criteria>

<output>
After completion, create `.planning/phases/01-tooling-practice/01-01-SUMMARY.md` using the summary template.
</output>
