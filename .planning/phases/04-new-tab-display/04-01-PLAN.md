---
phase: 04-new-tab-display
plan: "01"
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/CurrentlyReading.tsx
  - tests/browser/CurrentlyReading.test.tsx
autonomous: true
requirements:
  - DISP-01
  - DEV-05

must_haves:
  truths:
    - "Phase starts with a tidy-up commit (DEV-05) before any new work"
    - "CurrentlyReading component receives a BookRecord and renders it in a hero layout"
    - "The hero layout shows the book title prominently (visually dominant heading)"
    - "The hero layout shows the author(s) below the title"
    - "If the book has a coverUrl, the cover image is displayed"
    - "If the book has no coverUrl, the component renders without an image (no broken img tag)"
    - "The component includes status-change, edit, and delete action callbacks"
    - "All component logic written via TDD: browser tests first, implementation second"
    - "Tests exercise public interfaces only — no internal mocking"
  artifacts:
    - path: "src/components/CurrentlyReading.tsx"
      provides: "Hero display component for the currently-reading book with title, author, optional cover, and action callbacks"
    - path: "tests/browser/CurrentlyReading.test.tsx"
      provides: "Browser tests for CurrentlyReading component rendering and interactions"
  key_links:
    - from: "src/components/CurrentlyReading.tsx"
      to: "src/schema.ts"
      via: "Imports BookRecord and BookStatus types"
    - from: "src/components/CurrentlyReading.tsx"
      to: "src/newtab/App.tsx (Plan 04-03)"
      via: "App renders CurrentlyReading in the hero area when a book has Reading status"
---

<objective>
Start Phase 4 with mandatory tidy-up, then build the CurrentlyReading hero
component that displays the user's currently-reading book prominently on the
new tab page.

Purpose: DISP-01 requires the current book to be shown prominently — not
buried in a list. This component is the visual centrepiece of the new tab
experience. It receives a single BookRecord (already filtered to "reading"
status by the parent) and renders it in a hero layout with large title,
author, optional cover image, and action buttons for status change, edit,
and delete.

Output:
- Tidy-up commit
- src/components/CurrentlyReading.tsx — hero display component
- Browser tests for all rendering paths and interactions
</objective>

<execution_context>
@/Users/xavierbrinon/.config/Claude/get-shit-done/workflows/execute-plan.md
@/Users/xavierbrinon/.config/Claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.org
@.planning/STATE.org
@src/schema.ts
@src/components/BookCard.tsx
@src/newtab/App.tsx
@src/newtab/App.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Phase 4 tidy-up</name>
  <files></files>
  <action>
Mandatory tidy-up before new feature code (DEV-05):

1. Run `npm run lint` and fix any warnings
2. Run `npm run fmt:check` and fix any formatting issues
3. Run `npm test` and confirm all 81 tests pass
4. Review existing code for dead imports, unused variables, inconsistent naming
5. Commit tidy-up changes (if any) as a separate commit
  </action>
  <verify>
    <automated>npm run lint && npm run fmt:check && npm test</automated>
  </verify>
  <done>Codebase is clean; lint, format, and tests all pass; tidy-up commit created (or no changes needed)</done>
</task>

<task type="auto">
  <name>Task 2: Build CurrentlyReading component with TDD (browser tests)</name>
  <files>src/components/CurrentlyReading.tsx
tests/browser/CurrentlyReading.test.tsx</files>
  <action>
Write browser tests first, then implementation. Follow TDD red-green-refactor.

The CurrentlyReading component renders a single BookRecord in a hero layout.
Props:
  - book: BookRecord (the currently-reading book)
  - onStatusChange: (id: string, status: BookStatus) => void
  - onEdit: (id: string) => void
  - onDelete: (id: string) => void

Test 1 (RED): Renders the book title as a prominent heading
  → Create component skeleton, render title in an h2 (GREEN)

Test 2 (RED): Renders the author(s) below the title
  → Add author display, join multiple authors with ", " (GREEN)

Test 3 (RED): Renders the cover image when coverUrl is provided
  → Add img element when coverUrl exists (GREEN)

Test 4 (RED): Does not render an img element when coverUrl is absent
  → Conditional rendering for cover (GREEN)

Test 5 (RED): Shows a "Mark as Read" button that calls onStatusChange with "read"
  → Add button, wire onClick to call onStatusChange(book.id, "read") (GREEN)

Test 6 (RED): Shows an "Edit" button that calls onEdit with the book id
  → Add button, wire onClick (GREEN)

Test 7 (RED): Shows a "Delete" button that calls onDelete with the book id
  → Add button, wire onClick (GREEN)

Use a dedicated CSS class (e.g., "currently-reading") for the hero container
so it can be styled distinctly from BookCard. The hero should use larger
typography than regular cards — the component's semantic structure (h2, role,
class names) enables this.

Refactor pass: extract shared patterns if any, ensure clean prop types.
  </action>
  <verify>
    <automated>npm run test -- --project browser</automated>
  </verify>
  <done>CurrentlyReading component renders book in hero layout; all browser tests pass; cover image conditionally rendered; action buttons wired correctly</done>
</task>

</tasks>

<verification>
After all tasks complete:
1. `npm run lint && npm run fmt:check` pass
2. `npm run test` passes all tests (unit + browser + storybook)
3. `npm run build` succeeds
4. CurrentlyReading component renders a BookRecord with hero styling
5. Cover image is conditional (no broken img tags)
6. All action callbacks are wired
7. All code written via TDD red-green-refactor
</verification>

<success_criteria>
- CurrentlyReading component displays book title prominently (DISP-01 partial)
- Hero layout is visually distinct from the regular book list
- All action callbacks functional (status change, edit, delete)
- TDD red-green-refactor followed throughout
</success_criteria>

<output>
After completion, create `.planning/phases/04-new-tab-display/04-01-SUMMARY.md` using the summary template.
</output>
